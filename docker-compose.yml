version: "3.9"

services:
  pixloader:
    build:
      context: .
    container_name: pixloader
    restart: unless-stopped
    environment:
      - PIXIV_REFRESH_TOKEN=${PIXIV_REFRESH_TOKEN}
      - PIXIV_BOOKMARK_RESTRICT=${PIXIV_BOOKMARK_RESTRICT:-public}
      - PIXLOADER_DOWNLOAD_DIR=/data
      - PIXLOADER_MAX_PAGES=${PIXLOADER_MAX_PAGES:-0}
      - PIXLOADER_INTERVAL_SECONDS=${PIXLOADER_INTERVAL_SECONDS:-0}
      - PIXLOADER_CONCURRENCY=${PIXLOADER_CONCURRENCY:-4}
      - PIXLOADER_TOKEN_PORT=${PIXLOADER_TOKEN_PORT:-8080}
      - PIXLOADER_ALLOW_PASSWORD_LOGIN=${PIXLOADER_ALLOW_PASSWORD_LOGIN:-true}
      - PIXLOADER_ENABLE_VIEWER=${PIXLOADER_ENABLE_VIEWER:-true}
      - PIXLOADER_VIEWER_PORT=${PIXLOADER_VIEWER_PORT:-8081}
      - PIXLOADER_AUTO_SYNC_ON_START=${PIXLOADER_AUTO_SYNC_ON_START:-true}
    volumes:
      - '${PIXLOADER_HOST_ROOT:-./data}:/data'
    ports:
      - ${PIXLOADER_TOKEN_PORT:-8080}:${PIXLOADER_TOKEN_PORT:-8080}
      - ${PIXLOADER_VIEWER_PORT:-8081}:${PIXLOADER_VIEWER_PORT:-8081}
